<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="David W. Wright">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Geometry Optimization - BAC ESMACS Input Creation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Geometry Optimization";
    var mkdocs_page_input_path = "geometry_optimization.md";
    var mkdocs_page_url = "/geometry_optimization/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> BAC ESMACS Input Creation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../preparation/">Initial preparation</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Geometry Optimization</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#initial-steps-using-antechamber">Initial steps using Antechamber</a></li>
    

    <li class="toctree-l2"><a href="#hf6-31g-scftight-test-popmk-iop6332-iop6426-opt">HF/6-31G* SCF=tight Test Pop=MK iop(6/33=2) iop(6/42=6) opt</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#non-standard-approach-using-am1-bcc">Non-standard approach (using AM1-BCC)</a></li>
        
            <li><a class="toctree-l3" href="#geometry-optimization-gaussian">Geometry optimization (Gaussian)</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../parameter_derivation/">Parameter Derivation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../generate_bac_inputs/">Generate BAC inputs</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../testing/">Testing</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">BAC ESMACS Input Creation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Geometry Optimization</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/UCL-CCS/esmacs-input-creation-docs/blob/master/docs/geometry_optimization.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>The next stage will require that any hydrogens which are part of the ligand are added (these are usually not resolved in crystal structures).
AmberTools provides a tool for estimating the protonation of ligands called reduce.
To use this tool on the example 4BJX ligand extracted in the last section use the command:</p>
<pre><code>reduce 4bjx-ligand.pdb &gt; 4bjx-ligand-h.pdb
</code></pre>

<p>A wide variety of other ways to add these atoms are possible, one popular option in <a href="http://openbabel.org/">OpenBabel</a>.</p>
<h2 id="initial-steps-using-antechamber">Initial steps using Antechamber</h2>
<p>Antechamber is designed to allow the rapid generation of topology files for ligands using the generalized Amber force field (GAFF).
Two charge methods can be used HF/6-31G<em> RESP or AM1-BCC.
The work conducted to date with BAC has focussed on the HF/6-31G</em> RESP method used to parameterize much of the main Amber forcefield.
It is this approach that we will be detailing in the next two sections, although we will briefly mention the command used to complete the AM1-BCC approach as this eliminated the need for time consuming Gaussian calculations.</p>
<p>The first step to using Antechamber in this context is to generate the input file for Gaussian to optimize the ligand and generate a quantum-chemically calculated electrostatic potential.</p>
<p>For neutral ligands it is sufficient to specify only the input PDB (<code>-fi</code> specifies the format and <code>-i</code> the filename) and the output file (<code>-fo</code> specifies the format and <code>-o</code> the filename):</p>
<pre><code>antechamber -fi pdb -fo gcrt -i 4bjx-ligand-h.pdb -o 4bjx-ligand.gau
</code></pre>

<p>If the ligand is charged and extra option for the net charge, <code>-nc</code>, must be used.
For example if we thought the ligand had a charge of +1 we would use:</p>
<pre><code>antechamber -fi pdb -fo gcrt -i 4bjx-ligand-h.pdb -o 4bjx-ligand.gau -nc 1
</code></pre>

<p>The first few lines of the Gaussian input file generated will look something like this:</p>
<blockquote>
<p>--Link1--
%chk=molecule</p>
<h1 id="hf6-31g-scftight-test-popmk-iop6332-iop6426-opt">HF/6-31G* SCF=tight Test Pop=MK iop(6/33=2) iop(6/42=6) opt</h1>
<p>remark line goes here</p>
<p>0   1
   C   15.0320000000        6.0240000000       10.0040000000   <br />
   C   14.0090000000        5.1520000000        9.2570000000   <br />
   C   14.6530000000        4.2700000000        8.1860000000</p>
<p>...</p>
</blockquote>
<p>The meaning of the Gaussian options, found in the third line, are as follows:</p>
<ul>
<li>Opt: We ask for optimization of our structure</li>
<li>HF/6-31G*: We are using the 6-31G* basis set</li>
<li>Pop=MK: The output will contain Merz-Kollman atomic charges (fitted to the electrostatic potential)</li>
<li>iop(6/33=2): Output grid of values of describing the electrostatic potentail.
This will used in the latter RESP step to create the partial charges used in the final parameterization.</li>
</ul>
<p>The values on line 7 are the net charge and the multiplicity.</p>
<h3 id="non-standard-approach-using-am1-bcc">Non-standard approach (using AM1-BCC)</h3>
<p>This section is something of an aside and is included for completeness only, skip if you are only interested in creating standard BAC parameterizations.
If you wish to create the topology without Gaussian optimization and using the AM1-BCC approach to charges this can be achieved with a single command:</p>
<pre><code>antechamber -i 4bjx-ligand-h.pdb -fi pdb -o l01.prep -fo prepi -c bcc -at gaff -j 4 -rn L01
</code></pre>

<p>Here the ligand is renamed 'L01'.</p>
<p>If you use this approach you can skip the section below on Gaussian and the next Antechamber step and move straight to the <a href="">BAC input generation</a> section.</p>
<h2 id="geometry-optimization-gaussian">Geometry optimization (Gaussian)</h2>
<p>To run the geometry optimization in Gaussian and obtain the electrostatic potential it is a simple Gaussian run.
In principle this can be achieved using the command (for Gaussian 09):</p>
<pre><code>g09 &lt; 4bjx-ligand.gau &gt; 4bjx-ligand.out
</code></pre>

<p>However, this process can take a long time and it is recommended that the job is executed using a batch system. The details of executing that run will be dependent on your system setup.</p>
<p>In the next section we will use the electrostatic potential to generate partial charges for our ligand.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../parameter_derivation/" class="btn btn-neutral float-right" title="Parameter Derivation">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../preparation/" class="btn btn-neutral" title="Initial preparation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p><p>Created by David W. Wright</p> <img src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"> This work is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/"/>Creative Commons Attribution-ShareAlike 4.0 International License.</a></p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/UCL-CCS/esmacs-input-creation-docs" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../preparation/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../parameter_derivation/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>

</body>
</html>
