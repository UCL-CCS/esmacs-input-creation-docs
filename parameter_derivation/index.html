<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="David W. Wright">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Parameter Derivation - BAC ESMACS Input Creation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Parameter Derivation";
    var mkdocs_page_input_path = "parameter_derivation.md";
    var mkdocs_page_url = "/parameter_derivation/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> BAC ESMACS Input Creation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../preparation/">Initial preparation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../geometry_optimization/">Geometry Optimization</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Parameter Derivation</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#resp-fitting">RESP fitting</a></li>
    

    <li class="toctree-l2"><a href="#create-prep-and-frcmod-files">Create prep and frcmod files</a></li>
    

    <li class="toctree-l2"><a href="#check-all-is-well">Check all is well</a></li>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../generate_bac_inputs/">Generate BAC inputs</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../testing/">Testing</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">BAC ESMACS Input Creation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Parameter Derivation</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/UCL-CCS/esmacs-input-creation-docs/blob/master/docs/parameter_derivation.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>Now that the electrostatic potential is known we need to use this to produce a ligand description for incorporation into the Amber force field.</p>
<h2 id="resp-fitting">RESP fitting</h2>
<p>Once the electrostatic potential has been successfully generated a two step process is used to convert this into RESP fitted charges.
In these commands the new options are; <code>-c</code> charge method and <code>cf</code> for charge filename. The '.ac' file is an intermediate file and most options are selct explanatory, except <code>-c wc</code> which simply means 'write out charge'.</p>
<pre><code>antechamber -fi gout -fo ac -i 4bjx-ligand.out -o resp.ac -c resp
antechamber -fi ac -i resp.ac -c wc -cf resp.crg
</code></pre>

<h2 id="create-prep-and-frcmod-files">Create prep and frcmod files</h2>
<p>The goal of the parameterization is to create two files used by Amber to read a a paremeterized drug.
The first is a <em>.prep</em> file which adds a new residues to the standard Amber residue database.
The other is a force field parameter modification, or <em>.frcmod</em>, file which lists parameters for bonds and other components of the forcefield that need to be added to characterize the ligand.</p>
<p>At this stage you need to consider a name for the ligand to be used in the simulation.
The residue name must be 3 characters long, in this example we use 'L01'.
BAC requires that this name in lowercase letters <strong>must</strong> be used consistently throughout the rest of the process to name all files associated with the ligand (for instance the <em>l01.prep</em> file generated below).</p>
<pre><code>antechamber -i resp.ac -fi ac -c rc -cf resp.crg -o l01.prep -fo prepi -ao name -a 4bjx-ligand-h.pdb -fa pdb -rn L01
</code></pre>

<p>In this command, <code>-a</code> sets and additional file to be read for naming, <code>-ao name</code> means that only atom names are read from the input (rather than also including atom and bond types) and <code>-rn L01</code> sets the residue name.</p>
<p>Now we have the <em>.prep</em> file we need to use Antechamber to try and fill in any missing parameters in the force field by analogy to similar parameters which are present.
If Antechamber can't empirically calculate a value or has no analogy it will either add a default value that it thinks is reasonable or , in rare cases, insert a place holder.
This will contain zeros in all columns and be accompanied by the comment "ATTN: needs revision" in the output.
In these circumstances you will have to manually add these parameters.</p>
<pre><code>parmchk -i l01.prep -f prepi -o l01.frcmod
</code></pre>

<p>Finally we need to produce a PDB which contains the ligand labelled using the new name we have given it.
An easy way of achieving this is to run the command:</p>
<pre><code>sed 's/73B/L01/' 4bjx-ligand-h.pdb &gt; l01.pdb
</code></pre>

<p>Remove any header lines from the resultant PDB (<code>reduce</code> adds one beginning 'USER  MOD').</p>
<p>For use in BAC the ligand PDB (<em>l01.pdb</em> in the example) should be checked to ensure that it does not contain entries in the element column.
In particular entries for chlorine can be a problem.</p>
<h2 id="check-all-is-well">Check all is well</h2>
<p><em>test.leapin</em></p>
<pre><code>source leaprc.gaff
frcmod = loadamberparams l01.frcmod
loadamberprep l01.prep
mol = loadpdb l01.pdb
saveamberprep mol test.prepc
saveamberparm mol test.top test.crd
savepdb mol test.pdb
quit
</code></pre>

<p>A common reason for failure is that some atom names change capitalization in the Antechamber process (in particular 'CL' becoming 'Cl' and 'BR' turning into 'Br').
It is easiest to change the case in the PDB as the entries only appear once (as opposed to the <em>.prep</em> file where they appear in atom and connectivity lines).</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../generate_bac_inputs/" class="btn btn-neutral float-right" title="Generate BAC inputs">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../geometry_optimization/" class="btn btn-neutral" title="Geometry Optimization"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p><p>Created by David W. Wright</p> <img src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"> This work is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/"/>Creative Commons Attribution-ShareAlike 4.0 International License.</a></p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/UCL-CCS/esmacs-input-creation-docs" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../geometry_optimization/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../generate_bac_inputs/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>

</body>
</html>
